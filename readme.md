# Детектор символов на номерных знаках

В этом проекте был проанализирован, очищенен и расширен набор данных в задаче распознавания символов на номерных знаках,
а также был обучен детектор на основе yolov7.
Проект включает в себя анализ, внедрение аугментации данных, обучение модели и инференс.


## Описание проекта

Цель данного проекта - разработать качественный детектор символов, способный обнаруживать и распознавать символы на номерных знаках с высокой точностью. 
Проект включает в себя следующие шаги:

1. **Анализ датасета**: Очистка, изучение данных и выявление дисбаланса классов. 
Также была попытка упрощения задачи при помощи создания границ рамок, которые бы содеражли вместо двух символов один. Результат эксперемента в experiment.ipynb.

2. **Аугментация данных**: Для устранения дисбаланса классов и увеличения разнообразия данных была использована аугментация.

3. **Обучение модели**: Мы использовали YOLOv7 для обучения модели на наших данных.

4. **Инференс**: Модель может быть использована для распознавания символов на номерных знаках в реальном времени.

## Требования

Часть работы была проделана локально, для обучения модели был использован Google Colab
Перед тем как начать использовать проект, убедитесь, что у вас установлены следующие требования:

- Python 3.7
-  Зависимости из requirements.txt

## Использование
Для повторения эксперимента требуется последовательный запуск jupyter ноутбуков: 
- EDA.ipynb содержит основную часть анализа, а также создание аугментации данных и нового csv файла с новой разметкой. 
- prepare_data_for_yolo.ipynb преобразует данные полученные из EDA.ipynb в формат yolo и создает необходимые файлы для дальнейшей работы
- train_and_inference_yolov7.ipynb обучение и инференс сети. 
Запускался в Google Colab и использовал данные из Google Drive, инструкция по запуску имеется внутри ноутбука

## Результаты
Не были использованы все виды моделей из 7-ого семейства yolo, из-за ограничений графичских мощностей в Google Colab и недостатком их на своем устройстве.

[Веса обученной модели](https://drive.google.com/file/d/108uE9SrGDuKTN-T7XSseElxMAErSztxR/view?usp=sharing)

График обучения
![График обучения](images/results.png) 

Матрица ошибок
![Матрица ошибок](images/confusion_matrix.png) 

Пример работы сети на тестовой выборке 

Полноценный результат работы сети на тестовой выборке показан в train_and_inference_yolov7.ipynb

![Матрица ошибок](images/example_test.jpeg)

Матрица ошибок на тестовой выборке
![Матрица ошибок](images/confusion_matrix_test.png) 

Точность yolov7 достаточно высока, но не смотря на это в продолжении этой работы можно произвести сравнение с такими сетями как:
CRNN (Convolutional Recurrent Neural Network), Tesseract и EAST (Efficient and Accurate Scene Text Detector)

